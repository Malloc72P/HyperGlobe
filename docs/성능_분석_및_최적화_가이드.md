# HyperGlobe ì„±ëŠ¥ ë¶„ì„ ë° ìµœì í™” ê°€ì´ë“œ

## ğŸ“Š ì„±ëŠ¥ ë¶„ì„ ê°œìš”

### ì¸¡ì • í™˜ê²½
- **í…ŒìŠ¤íŠ¸ ê¸°ê¸°**: M1 MacBook
- **ì¸¡ì • ëŒ€ìƒ**: world-low, world-mid, world-high geo.json
- **ì¸¡ì • ì§€í‘œ**: FPS (ì´ˆë‹¹ í”„ë ˆì„ ìˆ˜), ë“œë¡œìš°ì½œ ìˆ˜, ì§€ì˜¤ë©”íŠ¸ë¦¬ ìˆ˜

### ì¸¡ì • ê²°ê³¼

#### ìµœì í™” ì „
```
world-low  (10,853 ì¢Œí‘œ): 60 fps âœ…
world-mid  (14,016 ì¢Œí‘œ): 55-60 fps âœ…
world-high (62,032 ì¢Œí‘œ): 24 fps ğŸ”´

ë“œë¡œìš°ì½œ: 4,320ê°œ
ì§€ì˜¤ë©”íŠ¸ë¦¬: 2,892ê°œ
ì‚¼ê°í˜•: 506,602ê°œ
```

**ë¬¸ì œ ìƒí™©:**
- world-mid â†’ world-highë¡œ ê°ˆ ë•Œ ì¢Œí‘œ ìˆ˜ 4.4ë°° ì¦ê°€
- FPSëŠ” 60% ê°ì†Œ (55fps â†’ 24fps)
- ì‹¬ê°í•œ ë¹„ì„ í˜•ì  ì„±ëŠ¥ ì €í•˜ ë°œìƒ

#### ìµœì í™” í›„ (RegionFeature ë‚´ë¶€ ë³‘í•©)
```
world-high (62,032 ì¢Œí‘œ): 58-60 fps âœ…

ë“œë¡œìš°ì½œ: 512ê°œ (88% ê°ì†Œ)
ì§€ì˜¤ë©”íŠ¸ë¦¬: 548ê°œ (81% ê°ì†Œ)
ì‚¼ê°í˜•: ì•½ 170,000ê°œ (ì¶”ì •, 66% ê°ì†Œ)
```

**ê°œì„  íš¨ê³¼:**
- FPS: 24 â†’ 58~60 (+142% í–¥ìƒ)
- ë“œë¡œìš°ì½œ: 4,320 â†’ 512 (88% ê°ì†Œ)
- ì§€ì˜¤ë©”íŠ¸ë¦¬: 2,892 â†’ 548 (81% ê°ì†Œ)

---

## ğŸ” GeoJSON ë°ì´í„° ë¶„ì„

### íŒŒì¼ë³„ í†µê³„
| íŒŒì¼ | í”¼ì²˜ ìˆ˜ | ì´ ì¢Œí‘œ ìˆ˜ | ë§(Ring) ìˆ˜ | í‰ê·  ë§ë‹¹ ì¢Œí‘œ | íŒŒì¼ í¬ê¸° |
|------|---------|-----------|------------|---------------|----------|
| world-low | 256 | 10,853 | 401 | 27 | 0.25MB |
| world-mid | 256 | 14,016 | 459 | 31 | 0.30MB |
| world-high | 256 | 62,032 | 1,435 | 43 | 1.16MB |

### ì£¼ìš” íŠ¹ì§•
- **í”¼ì²˜ ìˆ˜**: ëª¨ë‘ ë™ì¼ (256ê°œ êµ­ê°€)
- **ì¢Œí‘œ ë°€ë„**: highëŠ” low ëŒ€ë¹„ **5.7ë°°** ë” ë§ì€ ì¢Œí‘œ
- **ë§ ë³µì¡ë„**: highëŠ” low ëŒ€ë¹„ **3.6ë°°** ë” ë§ì€ ë§
- **ìµœëŒ€ ë³µì¡ êµ­ê°€**: ìºë‚˜ë‹¤ (world-highì—ì„œ 5,422ê°œ ì¢Œí‘œ)

---

## ğŸ”´ ì„±ëŠ¥ ë³‘ëª© ì§€ì  ë¶„ì„ (ìµœì í™” ì „)

### 1. ëŸ°íƒ€ì„ ì‚¼ê°ë¶„í•  (Critical âš ï¸âš ï¸âš ï¸)

**ë¬¸ì œ êµ¬í˜„:**
```tsx
// PolygonFeature.tsx - ê° ë§ë§ˆë‹¤ ê°œë³„ ì‚¼ê°ë¶„í• 
const fillGeometry = useMemo(() => {
  const { vertices, indices } = triangulatePolygon({
    coordinates: polygons,
    radius: fillRadius,
    gridSpacing: 3,
    densifyBoundary: true,
  });
  // BufferGeometry ìƒì„±...
}, [polygons, gridSpacing, densifyBoundary]);
```

**ë¬¸ì œì :**
- 1,435ê°œ ë§(world-high) ê°ê°ì— ëŒ€í•´ **ë¸Œë¼ìš°ì €ì—ì„œ** Delaunay ì‚¼ê°ë¶„í•  ìˆ˜í–‰
- ì´ˆê¸° ë¡œë”© ì‹œê°„: 3~7ì´ˆ
- UI ë¸”ë¡œí‚¹ ë°œìƒ
- 506,602ê°œ ì‚¼ê°í˜• ìƒì„± â†’ GPU ë©”ëª¨ë¦¬ ë¶€ë‹´

**ì˜í–¥ë„:** â­â­â­â­â­

---

### 2. ê³¼ë„í•œ ë“œë¡œìš°ì½œ (Draw Call Overhead) - âœ… í•´ê²°ë¨

**ë¬¸ì œ êµ¬í˜„:**
```tsx
// RegionFeature.tsx - ê° ë§ë§ˆë‹¤ ë³„ë„ ì»´í¬ë„ŒíŠ¸
{featurePolygons.map((polygon, i) => (
  <PolygonFeature key={i} polygons={polygon} ... />
))}

// PolygonFeature.tsx - ê° í´ë¦¬ê³¤ë§ˆë‹¤
<LineFeature ... />  // ë“œë¡œìš°ì½œ 1
<mesh ... />         // ë“œë¡œìš°ì½œ 1
```

**ë¬¸ì œì :**
- world-high: 1,435ê°œ ë§ â†’ **ìµœì†Œ 2,870ê°œ ë“œë¡œìš°ì½œ**
- ì‹¤ì œ ì¸¡ì •: 4,320ê°œ ë“œë¡œìš°ì½œ (ì™¸ê³½ì„ , ê·¸ë¦¼ì ë“± í¬í•¨)
- ê¶Œì¥ì¹˜(200)ì˜ 21ë°° ì´ˆê³¼

**í•´ê²° ë°©ë²•:** âœ… RegionFeature ë‚´ë¶€ì—ì„œ ë§ ë³‘í•©
```tsx
// RegionFeature.tsx - ìµœì í™”ëœ êµ¬í˜„
const regionFeatureGeometry = useMemo(() => {
  if (!meshSource) return;
  
  // ëª¨ë“  ë§ì˜ geometryë¥¼ í•˜ë‚˜ë¡œ ë³‘í•©
  const geometry = mergeGeometries(meshSource);
  
  return { geometry };
}, [meshSource]);

// ê²°ê³¼: êµ­ê°€ë‹¹ 1ê°œ mesh = 256ê°œ ë“œë¡œìš°ì½œ
```

**ê°œì„  íš¨ê³¼:**
- ë“œë¡œìš°ì½œ: 4,320 â†’ 512 (88% ê°ì†Œ)
- ì§€ì˜¤ë©”íŠ¸ë¦¬: 2,892 â†’ 548 (81% ê°ì†Œ)
- FPS: 24 â†’ 58~60 (+142% í–¥ìƒ)

**ì˜í–¥ë„:** â­â­â­â­â­ (í•´ê²°ë¨)

---

### 3. ì™¸ê³½ì„  ë Œë”ë§ ìµœì í™” - âœ… í•´ê²°ë¨

**ë¬¸ì œ êµ¬í˜„:**
```tsx
// ê° ë§ë§ˆë‹¤ ë³„ë„ LineFeature
{featurePolygons.map((polygon, i) => (
  <LineFeature coordinates={polygon} ... />
))}
```

**í•´ê²° ë°©ë²•:** âœ… LineSegmentsë¡œ ë³‘í•©
```tsx
const boundaryGeometry = useMemo(() => {
  const positions: number[] = [];
  
  // ëª¨ë“  ë§ì„ í•˜ë‚˜ì˜ LineSegmentsë¡œ ë³‘í•©
  for (const polygon of featurePolygons) {
    const projectedPoints = OrthographicProj.projects(polygon, fillRadius);
    
    for (let i = 0; i < projectedPoints.length; i++) {
      const [x1, y1, z1] = projectedPoints[i];
      const nextIndex = (i + 1) % projectedPoints.length;
      const [x2, y2, z2] = projectedPoints[nextIndex];
      
      positions.push(x1, y1, z1);
      positions.push(x2, y2, z2);
    }
  }
  
  const geometry = new THREE.BufferGeometry();
  geometry.setAttribute('position', new THREE.Float32BufferAttribute(positions, 3));
  
  return geometry;
}, [featurePolygons]);

<lineSegments geometry={boundaryGeometry}>
  <lineBasicMaterial />
</lineSegments>
```

**ì¥ì :**
- ë©€í‹°í´ë¦¬ê³¤ ì™„ë²½ ì§€ì› (ë–¨ì–´ì§„ ì„¬ë“¤ ê°ê° ë‹«íŒ ë£¨í”„)
- êµ­ê°€ë‹¹ 1ê°œ ë“œë¡œìš°ì½œ
- 256ê°œ ë¼ì¸ ë“œë¡œìš°ì½œ â†’ íš¨ìœ¨ì 

**ì˜í–¥ë„:** â­â­â­â­ (í•´ê²°ë¨)

---

### 4. í¬ì¸í„° ì´ë²¤íŠ¸ ë ˆì´ìºìŠ¤íŠ¸ ë¹„ìš©

**í˜„ì¬ êµ¬í˜„:**
```tsx
// RegionFeature.tsx
<group
  onPointerEnter={(e) => { 
    setHovered(true);
    setHoveredRegion(regionModel);
  }}
  onPointerLeave={(e) => { 
    setHovered(false);
    setHoveredRegion(null);
  }}
>
```

**ë¬¸ì œì :**
- ë§ˆìš°ìŠ¤ ì´ë™ ì‹œ 256ê°œ ë©”ì‰¬ ì „ì²´ì— ë ˆì´ìºìŠ¤íŠ¸ ìˆ˜í–‰
- React-three-fiberëŠ” ì´ë²¤íŠ¸ê°€ ìˆëŠ” ëª¨ë“  ê°ì²´ë¥¼ ë§¤ í”„ë ˆì„ ê²€ì‚¬
- ë³µì¡í•œ geometry(ìˆ˜ì²œ ê°œ ì‚¼ê°í˜•)ì¼ìˆ˜ë¡ ë¹„ìš© ì¦ê°€

**ì˜í–¥ë„:** â­â­â­

---

## ğŸ“ˆ ì„±ëŠ¥ ì¶”ì •ì¹˜

### í˜„ì¬ ë Œë”ë§ ë¹„ìš© (world-high ê¸°ì¤€)
```
ì…ë ¥ ì¢Œí‘œ ìˆ˜:     26,316
ê²©ì ê°„ê²©:        3ë„ (ê¸°ë³¸ê°’)
ìƒì„±ëœ ê²©ìì :    ì•½ 100,000+
ìƒì„±ëœ ì‚¼ê°í˜•:    ì•½ 180,000+ (ì „ì²´ 256ê°œ êµ­ê°€ í•©ì‚°)
ë“œë¡œìš°ì½œ ìˆ˜:      1,300+
ë©”ì‰¬ ìˆ˜:          256+
```

### M1 MacBook ì„±ëŠ¥ íŒë‹¨
- M1 í†µí•© GPUëŠ” 180k ì‚¼ê°í˜• ì •ë„ëŠ” ì²˜ë¦¬ ê°€ëŠ¥
- ê·¸ëŸ°ë°ë„ 40fps â†’ **JavaScript CPU ë³‘ëª© + ë“œë¡œìš°ì½œ ë³‘ëª©**
- ìˆœìˆ˜ GPU ë Œë”ë§ ë¶€í•˜ê°€ ì•„ë‹˜

---

## âœ… ìµœì¢… íŒë‹¨

### ğŸ¯ í˜„ì¬ 40fpsëŠ” ìµœì í™” í•„ìš”í•œ ìƒí™©

**ì´ìœ :**
1. âŒ ë°ì´í„° í•´ìƒë„ì˜ í•œê³„ê°€ ì•„ë‹˜
2. âœ… êµ¬í˜„ ë°©ì‹ì˜ ë¬¸ì œ
3. âœ… ìµœì í™”ë¡œ ì¶©ë¶„íˆ 60fps ë‹¬ì„± ê°€ëŠ¥

**ê·¼ê±°:**
- M1 MacBookì€ ì´ ì •ë„ ê·œëª¨ì˜ 3D ë Œë”ë§ì„ 60fpsë¡œ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” ì„±ëŠ¥
- ì£¼ìš” ë³‘ëª©ì€ **ëŸ°íƒ€ì„ ì‚¼ê°ë¶„í• (CPU)ê³¼ ê³¼ë„í•œ ë“œë¡œìš°ì½œ**
- ë¹„ìŠ·í•œ ê·œëª¨ì˜ ìµœì í™”ëœ 3D ì§€ë„ ë¼ì´ë¸ŒëŸ¬ë¦¬ë“¤ì€ 60fps ë‹¬ì„±

---

## âœ… ì ìš©ëœ ìµœì í™”

### RegionFeature ë‚´ë¶€ ë³‘í•© ìµœì í™” â­â­â­â­â­ (ì™„ë£Œ)

**êµ¬í˜„ ë‚´ìš©:**

1. **ë©”ì‰¬ ë³‘í•©**
```tsx
// ì—¬ëŸ¬ ê°œì˜ ë§ì„ í•˜ë‚˜ì˜ meshë¡œ ë³‘í•©
const regionFeatureGeometry = useMemo(() => {
  const geometries: THREE.BufferGeometry[] = [];
  
  for (const polygon of featurePolygons) {
    const { vertices, indices } = triangulatePolygon({...});
    const geometry = new THREE.BufferGeometry();
    // ... geometry ìƒì„±
    geometries.push(geometry);
  }
  
  // ë³‘í•©!
  return mergeGeometries(geometries);
}, [meshSource]);
```

2. **ì™¸ê³½ì„  ë³‘í•©**
```tsx
// ëª¨ë“  ë§ì˜ ì™¸ê³½ì„ ì„ í•˜ë‚˜ì˜ lineSegmentsë¡œ ë³‘í•©
const boundaryGeometry = useMemo(() => {
  const positions: number[] = [];
  
  for (const polygon of featurePolygons) {
    // ê° ë§ì„ ë…ë¦½ì ì¸ ë‹«íŒ ë£¨í”„ë¡œ ì²˜ë¦¬
    const projectedPoints = OrthographicProj.projects(polygon, fillRadius);
    
    for (let i = 0; i < projectedPoints.length; i++) {
      // ì„ ë¶„ ì¶”ê°€ (ë©€í‹°í´ë¦¬ê³¤ ì§€ì›)
      positions.push(...);
    }
  }
  
  return new THREE.BufferGeometry().setAttribute('position', ...);
}, [featurePolygons]);
```

**ë‹¬ì„± íš¨ê³¼:**
- âœ… ë“œë¡œìš°ì½œ: 2,055 â†’ 512 (75% ê°ì†Œ)
- âœ… ì§€ì˜¤ë©”íŠ¸ë¦¬: 1,382 â†’ 548 (60% ê°ì†Œ)
- âœ… FPS: 40 â†’ 58~60 (45% í–¥ìƒ)
- âœ… ê°œë³„ êµ­ê°€ë³„ hover/ìŠ¤íƒ€ì¼ ë³€ê²½ ê°€ëŠ¥ ìœ ì§€
- âœ… ë§µì°¨íŠ¸ë¡œì„œì˜ ë™ì  ê¸°ëŠ¥ ë³´ì¡´

**í•µì‹¬ ì´ì :**
- êµ­ê°€ë³„ ë…ë¦½ì ì¸ mesh ìœ ì§€ â†’ hover, ìƒ‰ìƒ ë³€ê²½ ê°€ëŠ¥
- ë‚´ë¶€ ë§ë“¤ë§Œ ë³‘í•© â†’ API ë³€ê²½ ì—†ìŒ
- ë©€í‹°í´ë¦¬ê³¤ ì™„ë²½ ì§€ì›
- ì‚¬ìš©ì ì½”ë“œ ë³€ê²½ ë¶ˆí•„ìš”

---

## ğŸš€ ì¶”ê°€ ìµœì í™” ê¶Œì¥ì‚¬í•­

### Priority 1: ë¹Œë“œ íƒ€ì„ ì‚¼ê°ë¶„í•  â­â­â­â­â­

**ê¸°ëŒ€ íš¨ê³¼:**
- ì´ˆê¸° ë¡œë”©: 2~5ì´ˆ â†’ 0.5ì´ˆ ë¯¸ë§Œ
- FPS í–¥ìƒ: +20~30
- CPU ë¶€í•˜ ì œê±°

**êµ¬í˜„ ë°©ì•ˆ:**
```bash
# 1. ë¹Œë“œ íƒ€ì„ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±
node scripts/preprocess-geojson.js

# 2. ê²°ê³¼ë¬¼ ìƒì„±
# world-high.geo.json â†’ world-high.triangulated.json
# { vertices: Float32Array, indices: Uint32Array, metadata: {...} }

# 3. ëŸ°íƒ€ì„ì—ì„œ ì‚¬ìš©
const preTriangulated = await import('./data/world-high.triangulated.json');
const geometry = new THREE.BufferGeometry();
geometry.setAttribute('position', new THREE.Float32BufferAttribute(preTriangulated.vertices, 3));
geometry.setIndex(preTriangulated.indices);
```

**ì¥ì :**
- CPU ì‘ì—… ì™„ì „ ì œê±°
- ì¼ê´€ëœ ì„±ëŠ¥ (ê¸°ê¸°ì— ë¬´ê´€)
- ë©”ëª¨ë¦¬ë§Œ ì‚¬ìš©

**ë‹¨ì :**
- ë¹Œë“œ íŒŒì¼ í¬ê¸° ì¦ê°€ (ì˜ˆìƒ: +2~3MB)
- ë¹Œë“œ ì‹œê°„ ì¦ê°€ (í•œ ë²ˆë§Œ)

---

### Priority 2: ì „ì²´ ë©”ì‰¬ ë³‘í•© (ì„ íƒì ) â­â­â­

**í˜„ì¬ ìƒíƒœ:**
- RegionFeature ë‚´ë¶€ ë³‘í•©ìœ¼ë¡œ ì´ë¯¸ 512 ë“œë¡œìš°ì½œ ë‹¬ì„±
- 60fps ìœ ì§€ ê°€ëŠ¥
- êµ­ê°€ë³„ ì œì–´ ê°€ëŠ¥

**ì¶”ê°€ ìµœì í™” ê°€ëŠ¥ (í•„ìš”ì‹œ):**
ëª¨ë“  êµ­ê°€ë¥¼ í•˜ë‚˜ì˜ ë©”ì‰¬ë¡œ ë³‘í•©í•˜ë©´ ë“œë¡œìš°ì½œì„ 1~2ê°œë¡œ ì¤„ì¼ ìˆ˜ ìˆìœ¼ë‚˜, ë‹¤ìŒ ì œì•½ì‚¬í•­ì´ ìˆìŒ:

**íŠ¸ë ˆì´ë“œì˜¤í”„:**
- âœ… ë“œë¡œìš°ì½œ 512 â†’ 1~2ê°œ
- âš ï¸ **êµ­ê°€ë³„ hover ë¶ˆê°€** (Face Index ë§¤í•‘ í•„ìš”)
- âš ï¸ **ë™ì  ìƒ‰ìƒ ë³€ê²½ ë³µì¡** (Vertex Color ë˜ëŠ” Custom Shader í•„ìš”)
- âš ï¸ **ë§µì°¨íŠ¸ ê¸°ëŠ¥ ì œì•½** (ë°ì´í„° ë°”ì¸ë”© ë°©ì‹ ë³€ê²½ í•„ìš”)

**ê²°ë¡ :** 
í˜„ì¬ ì„±ëŠ¥(58-60fps)ì´ ì¶©ë¶„í•˜ë¯€ë¡œ **ì ìš© ë¶ˆí•„ìš”**. 
ë§µì°¨íŠ¸ë¡œì„œì˜ ìœ ì—°ì„±ì„ ìœ ì§€í•˜ëŠ” ê²ƒì´ ë” ì¤‘ìš”í•¨.

---

### Priority 3: í¬ì¸í„° ì´ë²¤íŠ¸ ìµœì í™” â­â­â­

**ê¸°ëŒ€ íš¨ê³¼:**
- ë§ˆìš°ìŠ¤ ì´ë™ ì‹œ ë²„ë²…ì„ ì œê±°
- ë ˆì´ìºìŠ¤íŠ¸ ë¹„ìš© 90% ê°ì†Œ

**ë°©ì•ˆ A: ë‹¨ì¼ ë ˆì´ìºìŠ¤íŠ¸ + Face Index ë§¤í•‘**
```tsx
// ë³‘í•©ëœ ë©”ì‰¬ì—ë§Œ ì´ë²¤íŠ¸ ë¶€ì°©
const faceIndexToCountryMap = useMemo(() => {
  const map = new Map();
  let faceOffset = 0;
  
  features.forEach((feature, countryIndex) => {
    const triangleCount = getTriangleCount(feature);
    for (let i = 0; i < triangleCount; i++) {
      map.set(faceOffset + i, countryIndex);
    }
    faceOffset += triangleCount;
  });
  
  return map;
}, [features]);

<mesh 
  geometry={mergedGeometry}
  onPointerMove={(e) => {
    const faceIndex = e.faceIndex;
    const countryId = faceIndexToCountryMap.get(faceIndex);
    setHoveredCountry(countryId);
  }}
/>
```

**ë°©ì•ˆ B: Spatial Index (R-tree)**
```tsx
import RBush from 'rbush';

// êµ­ê°€ë³„ bounding boxë¡œ R-tree ìƒì„±
const spatialIndex = useMemo(() => {
  const tree = new RBush();
  const items = features.map(feature => ({
    minX: ..., minY: ..., maxX: ..., maxY: ...,
    countryId: feature.id
  }));
  tree.load(items);
  return tree;
}, [features]);

// ë§ˆìš°ìŠ¤ ìœ„ì¹˜ â†’ í›„ë³´ êµ­ê°€ í•„í„°ë§ â†’ ë ˆì´ìºìŠ¤íŠ¸
const candidateCountries = spatialIndex.search({
  minX: mouseX - 0.1, maxX: mouseX + 0.1,
  minY: mouseY - 0.1, maxY: mouseY + 0.1
});
```

---

### Priority 4: LOD (Level of Detail) â­â­â­

**ê¸°ëŒ€ íš¨ê³¼:**
- ì¤Œ ë ˆë²¨ì— ë”°ë¼ ìë™ ì„±ëŠ¥ ì¡°ì ˆ
- ì‚¬ìš©ì ê²½í—˜ ê°œì„ 

**êµ¬í˜„ ë°©ì•ˆ:**
```tsx
import { useThree } from '@react-three/fiber';

function useGeoJsonLOD() {
  const { camera } = useThree();
  const [geoJson, setGeoJson] = useState(worldMid);
  
  useFrame(() => {
    const distance = camera.position.length();
    
    if (distance < 3 && geoJson !== worldHigh) {
      setGeoJson(worldHigh);
    } else if (distance >= 3 && distance < 6 && geoJson !== worldMid) {
      setGeoJson(worldMid);
    } else if (distance >= 6 && geoJson !== worldLow) {
      setGeoJson(worldLow);
    }
  });
  
  return geoJson;
}

// ì‚¬ìš©
export function NationsDemo() {
  const geoJson = useGeoJsonLOD();
  
  return (
    <HyperGlobe>
      {geoJson.features.map(feature => (
        <RegionFeature key={feature.id} feature={feature} />
      ))}
    </HyperGlobe>
  );
}
```

**LOD ë ˆë²¨ ê¶Œì¥:**
- ê±°ë¦¬ < 3: world-high
- ê±°ë¦¬ 3~6: world-mid
- ê±°ë¦¬ > 6: world-low

---

### Priority 5: gridSpacing ë™ì  ì¡°ì • â­â­

**ê¸°ëŒ€ íš¨ê³¼:**
- ì‚¼ê°í˜• ìˆ˜ 30~50% ê°ì†Œ
- ì¦‰ê°ì ì¸ FPS í–¥ìƒ

**êµ¬í˜„ ë°©ì•ˆ:**
```tsx
// ë°ì´í„° í•´ìƒë„ì— ë”°ë¥¸ gridSpacing ê¶Œì¥ê°’
const GRID_SPACING_CONFIG = {
  'world-low': 7,   // ì„±ê¸´ ê²©ì
  'world-mid': 5,   // ë³´í†µ ê²©ì
  'world-high': 3,  // ì´˜ì´˜í•œ ê²©ì
};

// ë˜ëŠ” ë™ì  ê³„ì‚°
function calculateGridSpacing(coordinateCount: number): number {
  if (coordinateCount < 100) return 2;
  if (coordinateCount < 500) return 3;
  if (coordinateCount < 1000) return 4;
  return 5;
}

<PolygonFeature 
  polygons={polygon}
  gridSpacing={calculateGridSpacing(polygon.length)}
/>
```

**íŠ¸ë ˆì´ë“œì˜¤í”„:**
- âœ… ì¦‰ê°ì ì¸ ì„±ëŠ¥ í–¥ìƒ
- âš ï¸ í° í´ë¦¬ê³¤ì—ì„œ ì‹œê°ì  í’ˆì§ˆ ì•½ê°„ ì €í•˜ (ëŒ€ë¶€ë¶„ ëˆˆì— ë„ì§€ ì•ŠìŒ)

---

## ğŸ§ª ë¹ ë¥¸ ê²€ì¦ ë°©ë²•

### 1ë‹¨ê³„: gridSpacing ì¦ê°€ í…ŒìŠ¤íŠ¸ (30ì´ˆ ì†Œìš”)

**ëª©ì :** ì‚¼ê°í˜• ìˆ˜ ê°ì†Œ íš¨ê³¼ í™•ì¸

```tsx
// nations.tsx ìˆ˜ì •
<RegionFeature
  gridSpacing={5}  // ê¸°ë³¸ê°’ 3 â†’ 5ë¡œ ë³€ê²½
  feature={feature}
  ...
/>
```

**ì˜ˆìƒ ê²°ê³¼:**
- 40fps â†’ 48~52fps (ì•½ 20% í–¥ìƒ)
- ì‹œê°ì  í’ˆì§ˆì€ ê±°ì˜ ë™ì¼

---

### 2ë‹¨ê³„: ë Œë”ëŸ¬ í†µê³„ í™•ì¸ (1ë¶„ ì†Œìš”)

**ëª©ì :** ë“œë¡œìš°ì½œ ìˆ˜ì™€ ì‚¼ê°í˜• ìˆ˜ ì¸¡ì •

```tsx
// HyperGlobe.tsxì— ì¶”ê°€
import { useFrame, useThree } from '@react-three/fiber';

export function HyperGlobe({ children, showFpsCounter, ...props }) {
  const { gl } = useThree();
  
  useFrame(() => {
    if (showFpsCounter) {
      console.log({
        drawCalls: gl.info.render.calls,
        triangles: gl.info.render.triangles,
        geometries: gl.info.memory.geometries,
        textures: gl.info.memory.textures,
      });
    }
  });
  
  // ... ê¸°ì¡´ ì½”ë“œ
}
```

**í™•ì¸ ì‚¬í•­:**
- `drawCalls`: ëª©í‘œ < 200, í˜„ì¬ ì˜ˆìƒ 1,300+
- `triangles`: í˜„ì¬ ì˜ˆìƒ 180,000+

---

### 3ë‹¨ê³„: Chrome DevTools í”„ë¡œíŒŒì¼ë§ (3ë¶„ ì†Œìš”)

**ëª©ì :** CPU ë³‘ëª© ì§€ì  í™•ì¸

1. Chrome DevTools ì—´ê¸° (F12)
2. Performance íƒ­ ì„ íƒ
3. ë…¹í™” ì‹œì‘ â†’ ì§€êµ¬ë³¸ íšŒì „ â†’ ë…¹í™” ì¢…ë£Œ
4. í™•ì¸ ì‚¬í•­:
   - í”„ë ˆì„ë‹¹ ì‹œê°„ (ëª©í‘œ: < 16.6ms)
   - JavaScript ì‹¤í–‰ ì‹œê°„
   - Rendering ì‹œê°„
   - `triangulatePolygon` í•¨ìˆ˜ ì‹¤í–‰ ì‹œê°„

---

## ğŸ“Š ì„±ëŠ¥ ê°œì„  íš¨ê³¼ (ì‹¤ì œ ì¸¡ì •)

### ìµœì í™” ì „í›„ ë¹„êµ (world-high ê¸°ì¤€)

| ì§€í‘œ | ìµœì í™” ì „ | RegionFeature ë³‘í•© í›„ | ëª©í‘œ |
|------|----------|---------------------|------|
| **FPS** | 40 | 58-60 âœ… | 60 |
| **ë“œë¡œìš°ì½œ** | 2,055 | 512 âœ… | < 500 |
| **ì§€ì˜¤ë©”íŠ¸ë¦¬** | 1,382 | 548 âœ… | < 600 |
| **ì‚¼ê°í˜• ìˆ˜** | 230,446 | 76,768 âœ… | < 100k |
| **ì´ˆê¸° ë¡œë”©** | 2-3ì´ˆ | 1-2ì´ˆ | < 1ì´ˆ |
| **êµ­ê°€ë³„ ì œì–´** | âœ… | âœ… | í•„ìˆ˜ |

### ë‹¬ì„±ëœ ê°œì„ 
```
âœ… FPS: 40 â†’ 58-60 (45% í–¥ìƒ)
âœ… ë“œë¡œìš°ì½œ: 2,055 â†’ 512 (75% ê°ì†Œ)
âœ… ì§€ì˜¤ë©”íŠ¸ë¦¬: 1,382 â†’ 548 (60% ê°ì†Œ)
âœ… ì‚¼ê°í˜•: 230k â†’ 76k (67% ê°ì†Œ)
âœ… ë§µì°¨íŠ¸ ê¸°ëŠ¥ ì™„ì „ ìœ ì§€
```

### ì¶”ê°€ ìµœì í™” ê°€ëŠ¥ì„±
```
í˜„ì¬:              58-60 fps
+ ë¹Œë“œíƒ€ì„ ì‚¼ê°ë¶„í• :  60 fps (ì´ˆê¸° ë¡œë”© ê°œì„ )
+ gridSpacing ì¡°ì •:  60 fps (ë©”ëª¨ë¦¬ ì ˆì•½)
+ LOD ì‹œìŠ¤í…œ:        60 fps (í™•ëŒ€/ì¶•ì†Œ ìµœì í™”)
```

---

## ğŸ¯ ìµœì í™” ì ìš© í˜„í™©

### âœ… Phase 1: RegionFeature ë³‘í•© ìµœì í™” (ì™„ë£Œ)
1. âœ… RegionFeature ë‚´ë¶€ ë§ ë³‘í•© êµ¬í˜„
2. âœ… LineSegmentsë¡œ ì™¸ê³½ì„  ë³‘í•©
3. âœ… ë©€í‹°í´ë¦¬ê³¤ ì§€ì›
4. âœ… êµ­ê°€ë³„ hover/ìŠ¤íƒ€ì¼ ë³€ê²½ ìœ ì§€
5. âœ… FPS Counter ì¶”ê°€
6. âœ… ì„±ëŠ¥ ì¸¡ì • ë° ê²€ì¦ ì™„ë£Œ

**ê²°ê³¼:**
- ë“œë¡œìš°ì½œ 75% ê°ì†Œ
- FPS 45% í–¥ìƒ
- ë§µì°¨íŠ¸ ê¸°ëŠ¥ ì™„ì „ ìœ ì§€

---

### ğŸ”œ Phase 2: ì¶”ê°€ ìµœì í™” (ì„ íƒì )

í˜„ì¬ ì„±ëŠ¥ì´ ëª©í‘œ(58-60fps)ë¥¼ ë‹¬ì„±í–ˆìœ¼ë¯€ë¡œ, ë‹¤ìŒ ìµœì í™”ëŠ” **í•„ìš”ì‹œì—ë§Œ** ì ìš©:

1. **ë¹Œë“œ íƒ€ì„ ì‚¼ê°ë¶„í• ** (ì´ˆê¸° ë¡œë”© ê°œì„ )
   - ëª©ì : 2-3ì´ˆ â†’ 0.5ì´ˆ ì´í•˜
   - ìš°ì„ ìˆœìœ„: ì¤‘ê°„
   - ë§µì°¨íŠ¸ ê¸°ëŠ¥ ì˜í–¥: ì—†ìŒ

2. **gridSpacing ë™ì  ì¡°ì •** (ë©”ëª¨ë¦¬ ì ˆì•½)
   - ëª©ì : ì‚¼ê°í˜• ìˆ˜ 30% ì¶”ê°€ ê°ì†Œ
   - ìš°ì„ ìˆœìœ„: ë‚®ìŒ
   - ë§µì°¨íŠ¸ ê¸°ëŠ¥ ì˜í–¥: ì—†ìŒ

3. **LOD ì‹œìŠ¤í…œ** (í™•ëŒ€/ì¶•ì†Œ ìµœì í™”)
   - ëª©ì : ì¹´ë©”ë¼ ê±°ë¦¬ì— ë”°ë¥¸ ìë™ í•´ìƒë„ ì „í™˜
   - ìš°ì„ ìˆœìœ„: ì¤‘ê°„
   - ë§µì°¨íŠ¸ ê¸°ëŠ¥ ì˜í–¥: ì—†ìŒ

---

### âŒ Phase 3: ì ìš© ë¶ˆê¶Œì¥

1. **ì „ì²´ ë©”ì‰¬ ë³‘í•©**
   - ì´ìœ : ë§µì°¨íŠ¸ ê¸°ëŠ¥ ì œì•½ (êµ­ê°€ë³„ ì œì–´ ë³µì¡)
   - ì„±ëŠ¥ ì´ë“: ë¯¸ë¯¸ (ì´ë¯¸ 60fps ë‹¬ì„±)
   - ê²°ë¡ : ì ìš© ë¶ˆí•„ìš”

---

## ğŸ“š ì°¸ê³  ìë£Œ

### Three.js ì„±ëŠ¥ ìµœì í™”
- [Three.js Performance Tips](https://discoverthreejs.com/tips-and-tricks/)
- [BufferGeometryUtils ë¬¸ì„œ](https://threejs.org/docs/#examples/en/utils/BufferGeometryUtils)
- [InstancedMesh ê°€ì´ë“œ](https://threejs.org/docs/#api/en/objects/InstancedMesh)

### ì‚¼ê°ë¶„í•  ì•Œê³ ë¦¬ì¦˜
- [Delaunator ë¼ì´ë¸ŒëŸ¬ë¦¬](https://github.com/mapbox/delaunator)
- [Polygon Triangulation on Globe - Stack Overflow](https://stackoverflow.com/questions/54484537/polygon-triangulation-for-globe)

### ì„±ëŠ¥ ì¸¡ì •
- [Chrome DevTools Performance](https://developer.chrome.com/docs/devtools/performance/)
- [React-three-fiber Performance](https://docs.pmnd.rs/react-three-fiber/advanced/pitfalls#performance-pitfalls)

---

## ğŸ“ í•µì‹¬ êµí›ˆ

### ìµœì í™” ì›ì¹™

1. **API í˜¸í™˜ì„± ìš°ì„ **
   - ì‚¬ìš©ì ì½”ë“œ ë³€ê²½ ì—†ì´ ë‚´ë¶€ ìµœì í™”
   - RegionFeature API ì™„ì „ ìœ ì§€
   
2. **ê¸°ëŠ¥ê³¼ ì„±ëŠ¥ì˜ ê· í˜•**
   - ë§µì°¨íŠ¸ë¡œì„œì˜ ë™ì  ê¸°ëŠ¥ ë³´ì¡´
   - êµ­ê°€ë³„ hover, ìƒ‰ìƒ ë³€ê²½ ê°€ëŠ¥
   
3. **ì ì§„ì  ê°œì„ **
   - í° ë¦¬íŒ©í† ë§ ì—†ì´ 75% ì„±ëŠ¥ ê°œì„ 
   - ë¦¬ìŠ¤í¬ ìµœì†Œí™”
   
4. **ì¸¡ì • ê¸°ë°˜ ìµœì í™”**
   - FPS Counter ì¶”ê°€ë¡œ ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§
   - ë“œë¡œìš°ì½œ, ì§€ì˜¤ë©”íŠ¸ë¦¬ ìˆ˜ ì¸¡ì •

### ì„±ê³µ ìš”ì¸

âœ… **RegionFeature ë ˆë²¨ì—ì„œ ë³‘í•©**
- êµ­ê°€ë³„ ë…ë¦½ì„± ìœ ì§€
- ë‚´ë¶€ ë§ë§Œ ë³‘í•©í•˜ì—¬ ë“œë¡œìš°ì½œ ê°ì†Œ
- ë©€í‹°í´ë¦¬ê³¤ ì™„ë²½ ì§€ì›

âœ… **LineSegments í™œìš©**
- ë–¨ì–´ì§„ ì„¬ë“¤ ê°ê° ë‹«íŒ ë£¨í”„ë¡œ ì²˜ë¦¬
- í•˜ë‚˜ì˜ ë“œë¡œìš°ì½œë¡œ ëª¨ë“  ì™¸ê³½ì„  ë Œë”ë§

âœ… **ë§µì°¨íŠ¸ ìš”êµ¬ì‚¬í•­ ì¶©ì¡±**
- hover ì´ë²¤íŠ¸ ìœ ì§€
- ë™ì  ìŠ¤íƒ€ì¼ ë³€ê²½ ê°€ëŠ¥
- ë°ì´í„° ë°”ì¸ë”© ì™„ì „ ì§€ì›

---

## ğŸ¤ ë‹¤ìŒ ë‹¨ê³„

### í˜„ì¬ ìƒíƒœ: ëª©í‘œ ë‹¬ì„± âœ…
- FPS: 58-60 (ëª©í‘œ ë‹¬ì„±)
- ë“œë¡œìš°ì½œ: 512 (ê¶Œì¥ ë²”ìœ„ ë‚´)
- ë§µì°¨íŠ¸ ê¸°ëŠ¥: ì™„ì „ ìœ ì§€

### ì„ íƒì  ê°œì„ ì‚¬í•­ (í•„ìš”ì‹œ)
1. **ë¹Œë“œ íƒ€ì„ ì‚¼ê°ë¶„í• ** (ì´ˆê¸° ë¡œë”© ê°œì„ )
2. **LOD ì‹œìŠ¤í…œ** (í™•ëŒ€/ì¶•ì†Œ ìµœì í™”)
3. **gridSpacing ì¡°ì •** (ë©”ëª¨ë¦¬ ì ˆì•½)

---

*ë¬¸ì„œ ìµœì¢… ìˆ˜ì •ì¼: 2025ë…„ 11ì›” 6ì¼*
*ìµœì í™” ì™„ë£Œ: RegionFeature ë³‘í•© (v1.0)*
*í…ŒìŠ¤íŠ¸ í™˜ê²½: M1 MacBook, world-high.geo.json*
